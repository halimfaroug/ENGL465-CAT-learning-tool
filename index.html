
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CATalyst - Complete Computer-Assisted Translation Learning Platform">
    <title>CATalyst - Complete CAT Learning Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --color-primary: #667eea;
            --color-secondary: #764ba2;
            --color-success: #48bb78;
            --color-warning: #ed8936;
            --color-danger: #f56565;
            --color-bg-dark: #0a0a2a;
            --color-bg-light: #1a1a4a;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Open Sans', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--color-bg-dark) 0%, var(--color-bg-light) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            color: #e2e8f0;
        }
        
        /* Galaxy Background */
        .galaxy-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            animation: twinkle linear infinite;
            will-change: opacity;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        .particle {
            position: absolute;
            background: radial-gradient(circle, rgba(102,126,234,0.8) 0%, rgba(102,126,234,0) 70%);
            border-radius: 50%;
            animation: float linear infinite;
            will-change: transform;
        }
        
        @keyframes float {
            0% { transform: translateY(0) translateX(0); }
            100% { transform: translateY(-100vh) translateX(100px); }
        }
        
        /* Typography */
        h1, h2, h3, h4, h5 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            color: #e2e8f0;
        }
        
        /* Components */
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            border-color: var(--color-primary);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Progress Bar */
        .progress-container {
            width: 100%;
            background-color: rgba(226, 232, 240, 0.2);
            border-radius: 10px;
            overflow: hidden;
            height: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        /* Flashcard */
        .flashcard-container {
            perspective: 1000px;
            height: 300px;
            margin: 20px auto;
        }
        
        .flashcard {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        
        .flashcard.flipped {
            transform: rotateY(180deg);
        }
        
        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .flashcard-front {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: white;
        }
        
        .flashcard-back {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            transform: rotateY(180deg);
        }
        
        /* Quiz */
        .quiz-option {
            padding: 15px;
            border: 2px solid rgba(226, 232, 240, 0.2);
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .quiz-option:hover {
            border-color: var(--color-primary);
            background: rgba(102, 126, 234, 0.1);
        }
        
        .quiz-option.selected {
            border-color: var(--color-success);
            background: rgba(72, 187, 120, 0.1);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .focus-visible:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .flashcard-container {
                height: 250px;
            }
            
            .mobile-hidden {
                display: none;
            }
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body class="antialiased">
    <!-- Galaxy Background -->
    <div class="galaxy-bg" id="galaxy" aria-hidden="true"></div>
    
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:bg-white focus:text-black focus:p-4 focus:rounded">
        Skip to main content
    </a>
    
    <div id="app" class="min-h-screen">
        <!-- Navigation -->
        <nav class="bg-gray-900/80 backdrop-blur-lg shadow-lg border-b border-gray-800">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center h-20">
                    <!-- Logo -->
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"
                             aria-hidden="true">
                            <i class="fas fa-language text-white text-lg"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-white">CATalyst</h1>
                            <p class="text-sm text-gray-400">Computer-Assisted Translation Learning</p>
                        </div>
                    </div>
                    
                    <!-- Desktop Navigation -->
                    <div class="hidden md:flex space-x-1" role="navigation" aria-label="Main">
                        <button class="nav-item active focus-visible" data-section="dashboard" aria-current="page">
                            <i class="fas fa-home mr-2" aria-hidden="true"></i>Dashboard
                        </button>
                        <button class="nav-item focus-visible" data-section="flashcards">
                            <i class="fas fa-layer-group mr-2" aria-hidden="true"></i>Flashcards
                        </button>
                        <button class="nav-item focus-visible" data-section="quiz">
                            <i class="fas fa-question-circle mr-2" aria-hidden="true"></i>Quiz
                        </button>
                        <button class="nav-item focus-visible" data-section="mindmaps">
                            <i class="fas fa-project-diagram mr-2" aria-hidden="true"></i>Mind Maps
                        </button>
                        <button class="nav-item focus-visible" data-section="progress">
                            <i class="fas fa-chart-line mr-2" aria-hidden="true"></i>Progress
                        </button>
                    </div>
                    
                    <!-- Mobile Menu Button -->
                    <button id="mobile-menu-btn" class="md:hidden w-10 h-10 flex items-center justify-center text-gray-300 hover:text-white focus-visible"
                            aria-label="Toggle menu" aria-expanded="false">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    
                    <!-- User Profile -->
                    <div class="hidden md:flex items-center space-x-4">
                        <div class="text-right">
                            <p class="text-sm font-medium text-gray-300">CATalyst Platform</p>
                            <p class="text-xs text-gray-500">Advanced Learning System</p>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"
                             aria-label="User profile">
                            <span class="text-white font-bold">C</span>
                        </div>
                    </div>
                </div>
                
                <!-- Mobile Navigation -->
                <div id="mobile-menu" class="md:hidden hidden py-4 border-t border-gray-800">
                    <div class="flex flex-col space-y-2">
                        <button class="nav-item active focus-visible" data-section="dashboard" aria-current="page">
                            <i class="fas fa-home mr-2" aria-hidden="true"></i>Dashboard
                        </button>
                        <button class="nav-item focus-visible" data-section="flashcards">
                            <i class="fas fa-layer-group mr-2" aria-hidden="true"></i>Flashcards
                        </button>
                        <button class="nav-item focus-visible" data-section="quiz">
                            <i class="fas fa-question-circle mr-2" aria-hidden="true"></i>Quiz
                        </button>
                        <button class="nav-item focus-visible" data-section="mindmaps">
                            <i class="fas fa-project-diagram mr-2" aria-hidden="true"></i>Mind Maps
                        </button>
                        <button class="nav-item focus-visible" data-section="progress">
                            <i class="fas fa-chart-line mr-2" aria-hidden="true"></i>Progress
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main id="main-content" class="container mx-auto px-4 py-8">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="space-y-8 fade-in">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                        Welcome to CATalyst
                    </h1>
                    <p class="text-lg text-gray-300 max-w-3xl mx-auto">
                        An advanced learning platform for Computer-Assisted Translation. Accelerate your understanding with interactive tools and visual learning.
                    </p>
                </div>

                <!-- Quick Stats -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card p-6" role="region" aria-label="Topics overview">
                        <div class="text-3xl font-bold text-blue-400 mb-2" id="topics-count">14</div>
                        <div class="text-gray-300 font-medium">Topics</div>
                        <p class="text-gray-400 text-sm mt-2">Complete coverage</p>
                    </div>
                    <div class="card p-6" role="region" aria-label="Flashcards overview">
                        <div class="text-3xl font-bold text-purple-400 mb-2" id="flashcards-count">100</div>
                        <div class="text-gray-300 font-medium">Flashcards</div>
                        <p class="text-gray-400 text-sm mt-2">Key concepts</p>
                    </div>
                    <div class="card p-6" role="region" aria-label="Quiz overview">
                        <div class="text-3xl font-bold text-green-400 mb-2" id="quiz-count">50</div>
                        <div class="text-gray-300 font-medium">Quiz Questions</div>
                        <p class="text-gray-400 text-sm mt-2">Test your knowledge</p>
                    </div>
                    <div class="card p-6" role="region" aria-label="Mind maps overview">
                        <div class="text-3xl font-bold text-yellow-400 mb-2" id="mindmaps-count">30</div>
                        <div class="text-gray-300 font-medium">Mind Maps</div>
                        <p class="text-gray-400 text-sm mt-2">Visual learning</p>
                    </div>
                </div>

                <!-- Course Topics -->
                <div class="card p-6">
                    <h2 class="text-2xl font-bold mb-6 text-white">Course Topics</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" role="list" aria-label="Course topics">
                        <!-- Topics will be dynamically loaded -->
                    </div>
                </div>
            </section>

            <!-- Flashcards Section -->
            <section id="flashcards-section" class="hidden fade-in" role="region" aria-label="Flashcards learning">
                <!-- Content same as before but with aria labels -->
            </section>

            <!-- Quiz Section -->
            <section id="quiz-section" class="hidden fade-in" role="region" aria-label="Quiz">
                <!-- Content same as before but with aria labels -->
            </section>

            <!-- Mind Maps Section -->
            <section id="mindmaps-section" class="hidden fade-in" role="region" aria-label="Mind maps">
                <!-- Content same as before but with aria labels -->
            </section>

            <!-- Progress Section -->
            <section id="progress-section" class="hidden fade-in" role="region" aria-label="Learning progress">
                <!-- Content same as before but with aria labels -->
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900/80 backdrop-blur-lg py-8 mt-12 border-t border-gray-800">
            <div class="container mx-auto px-4 text-center">
                <p class="text-lg mb-2 text-white">CATalyst - Computer-Assisted Translation Learning Platform</p>
                <p class="text-gray-400 mb-4">Accelerating translation technology education through interactive learning</p>
                <p class="text-sm text-gray-500">Developed by Prof. Halim Faroug A. Elhag | Lecturer of English Language, UHB/University of Khartoum | © <span id="current-year"></span> All rights reserved</p>
            </div>
        </footer>
    </div>

    <script>
        // Improved state management
        class AppState {
            constructor() {
                this.currentSection = 'dashboard';
                this.currentCardIndex = 0;
                this.currentQuestionIndex = 0;
                this.quizScore = 0;
                this.selectedQuizAnswer = null;
                this.currentTopic = 1;
                this.learnedCards = new Set();
                this.quizAttempts = new Map();
            }

            saveToLocalStorage() {
                const state = {
                    learnedCards: Array.from(this.learnedCards),
                    quizScore: this.quizScore,
                    quizAttempts: Array.from(this.quizAttempts.entries())
                };
                localStorage.setItem('catalyst-state', JSON.stringify(state));
            }

            loadFromLocalStorage() {
                const saved = localStorage.getItem('catalyst-state');
                if (saved) {
                    const state = JSON.parse(saved);
                    this.learnedCards = new Set(state.learnedCards);
                    this.quizScore = state.quizScore;
                    this.quizAttempts = new Map(state.quizAttempts);
                }
            }
        }

        const state = new AppState();

        // Improved data structures
        const TOPIC_NAMES = [
            "Introduction to CAT", "Translator's Workstation", "Translation Memory", 
            "Terminology Tools", "Why Translation is Difficult", "Commercial MT Systems",
            "Post-Editing", "Localization & Translation", "Corpora & Translation",
            "Evaluating MT", "Linguistics for MT", "Sublanguage",
            "MT for Minority Languages", "MT in the Classroom"
        ];

        const DATA = {
            flashcards: [], // Will be loaded from API or file
            quizQuestions: [],
            mindMaps: {},
            topics: []
        };

        // Initialize galaxy with optimized performance
        function initGalaxy() {
            const galaxy = document.getElementById('galaxy');
            const fragment = document.createDocumentFragment();
            
            // Use requestAnimationFrame for better performance
            const createStars = () => {
                for (let i = 0; i < 100; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    const size = Math.random() * 2 + 1;
                    star.style.cssText = `
                        width: ${size}px;
                        height: ${size}px;
                        left: ${Math.random() * 100}%;
                        top: ${Math.random() * 100}%;
                        animation-duration: ${Math.random() * 3 + 2}s;
                        animation-delay: ${Math.random() * 5}s;
                    `;
                    fragment.appendChild(star);
                }
                
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    const size = Math.random() * 80 + 40;
                    particle.style.cssText = `
                        width: ${size}px;
                        height: ${size}px;
                        left: ${Math.random() * 100}%;
                        top: ${Math.random() * 100 + 100}%;
                        animation-duration: ${Math.random() * 15 + 15}s;
                        animation-delay: ${Math.random() * 5}s;
                    `;
                    fragment.appendChild(particle);
                }
                
                galaxy.appendChild(fragment);
            };
            
            requestAnimationFrame(createStars);
        }

        // Improved section management
        class SectionManager {
            constructor() {
                this.sections = new Map();
                this.currentSection = 'dashboard';
            }

            register(id, element, callback = null) {
                this.sections.set(id, { element, callback });
            }

            show(id) {
                if (this.currentSection === id) return;
                
                // Hide current
                const current = this.sections.get(this.currentSection);
                if (current) {
                    current.element.classList.add('hidden');
                }
                
                // Update navigation
                this.updateNavigation(id);
                
                // Show new
                const next = this.sections.get(id);
                if (next) {
                    next.element.classList.remove('hidden');
                    next.element.classList.add('fade-in');
                    if (typeof next.callback === 'function') {
                        next.callback();
                    }
                }
                
                this.currentSection = id;
                document.dispatchEvent(new CustomEvent('sectionChanged', { detail: { section: id } }));
            }

            updateNavigation(id) {
                document.querySelectorAll('[data-section]').forEach(item => {
                    const isActive = item.dataset.section === id;
                    item.classList.toggle('active', isActive);
                    item.setAttribute('aria-current', isActive ? 'page' : null);
                });
            }
        }

        const sectionManager = new SectionManager();

        // Improved flashcard component
        class FlashcardManager {
            constructor() {
                this.cards = [];
                this.filteredCards = [];
                this.currentIndex = 0;
            }

            init(cards) {
                this.cards = cards;
                this.filteredCards = cards;
                this.renderList();
            }

            filterByTopic(topicId) {
                if (topicId === 'all') {
                    this.filteredCards = this.cards;
                } else {
                    this.filteredCards = this.cards.filter(card => card.topic == topicId);
                }
                this.currentIndex = 0;
                this.renderList();
                return this.filteredCards;
            }

            renderList() {
                const container = document.getElementById('flashcards-list');
                if (!container) return;
                
                container.innerHTML = this.filteredCards.slice(0, 20).map(card => `
                    <div class="bg-gray-800/30 p-4 rounded-lg cursor-pointer hover:bg-gray-800/50 border border-gray-700/50 transition-all"
                         onclick="flashcardManager.goToCard(${card.id})"
                         onkeydown="if(event.key === 'Enter') flashcardManager.goToCard(${card.id})"
                         tabindex="0"
                         role="button"
                         aria-label="View flashcard: ${card.front.substring(0, 50)}">
                        <div class="font-medium text-white mb-1">${this.truncateText(card.front, 60)}</div>
                        <div class="text-sm text-gray-400">${TOPIC_NAMES[card.topic - 1] || `Topic ${card.topic}`}</div>
                    </div>
                `).join('');
            }

            goToCard(cardId) {
                const index = this.filteredCards.findIndex(c => c.id === cardId);
                if (index !== -1) {
                    this.currentIndex = index;
                    this.renderCurrentCard();
                }
            }

            renderCurrentCard() {
                const card = this.filteredCards[this.currentIndex];
                if (!card) return;
                
                document.getElementById('card-front').textContent = card.front;
                document.getElementById('card-back').textContent = card.back;
                document.getElementById('card-topic').textContent = 
                    TOPIC_NAMES[card.topic - 1] || `Topic ${card.topic}`;
                
                this.updateProgress();
            }

            updateProgress() {
                const progress = ((this.currentIndex + 1) / this.filteredCards.length) * 100;
                const progressBar = document.getElementById('progress-bar');
                const cardProgress = document.getElementById('card-progress');
                
                if (progressBar) progressBar.style.width = `${progress}%`;
                if (cardProgress) cardProgress.textContent = 
                    `${this.currentIndex + 1}/${this.filteredCards.length}`;
            }

            truncateText(text, maxLength) {
                return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
            }

            next() {
                if (this.currentIndex < this.filteredCards.length - 1) {
                    this.currentIndex++;
                    this.renderCurrentCard();
                }
            }

            prev() {
                if (this.currentIndex > 0) {
                    this.currentIndex--;
                    this.renderCurrentCard();
                }
            }
        }

        const flashcardManager = new FlashcardManager();

        // Improved quiz manager
        class QuizManager {
            constructor() {
                this.questions = [];
                this.currentIndex = 0;
                this.score = 0;
                this.selectedAnswer = null;
                this.userAnswers = new Map();
            }

            init(questions) {
                this.questions = questions;
            }

            renderQuestion() {
                const question = this.questions[this.currentIndex];
                if (!question) return;
                
                document.getElementById('quiz-question').textContent = question.question;
                const container = document.getElementById('quiz-options');
                
                container.innerHTML = question.options.map((option, index) => `
                    <div class="quiz-option focus-visible"
                         onclick="quizManager.selectAnswer(${index}, this)"
                         onkeydown="if(event.key === 'Enter') quizManager.selectAnswer(${index}, this)"
                         tabindex="0"
                         role="radio"
                         aria-checked="${this.selectedAnswer === index}"
                         aria-label="Option ${String.fromCharCode(65 + index)}: ${option}">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-lg bg-gray-800 flex items-center justify-center mr-3" 
                                 aria-hidden="true">
                                ${String.fromCharCode(65 + index)}
                            </div>
                            <span>${option}</span>
                        </div>
                    </div>
                `).join('');
                
                this.updateProgress();
            }

            selectAnswer(index, element) {
                this.selectedAnswer = index;
                
                // Update UI
                document.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('selected');
                    opt.setAttribute('aria-checked', 'false');
                });
                
                element.classList.add('selected');
                element.setAttribute('aria-checked', 'true');
            }

            next() {
                if (this.selectedAnswer === null) {
                    alert('Please select an answer before proceeding.');
                    return;
                }
                
                // Save answer
                this.userAnswers.set(this.currentIndex, this.selectedAnswer);
                
                // Check if correct
                const question = this.questions[this.currentIndex];
                if (this.selectedAnswer === question.correct) {
                    this.score++;
                }
                
                // Move to next question or show results
                this.currentIndex++;
                this.selectedAnswer = null;
                
                if (this.currentIndex < this.questions.length) {
                    this.renderQuestion();
                } else {
                    this.showResults();
                }
            }

            showResults() {
                document.getElementById('quiz-results').classList.remove('hidden');
                const percentage = (this.score / this.questions.length) * 100;
                document.getElementById('final-score').textContent = 
                    `Score: ${this.score}/${this.questions.length} (${percentage.toFixed(0)}%)`;
                
                // Announce results for screen readers
                const resultsDiv = document.getElementById('quiz-results');
                resultsDiv.setAttribute('role', 'alert');
                resultsDiv.setAttribute('aria-live', 'polite');
            }

            updateProgress() {
                const progress = ((this.currentIndex + 1) / this.questions.length) * 100;
                document.getElementById('quiz-progress-bar').style.width = `${progress}%`;
                document.getElementById('quiz-progress').textContent = 
                    `Question ${this.currentIndex + 1}/${this.questions.length}`;
                document.getElementById('quiz-score').textContent = `Score: ${this.score}`;
                
                // Update button states
                document.getElementById('prev-question-btn').disabled = this.currentIndex === 0;
            }
        }

        const quizManager = new QuizManager();

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            // Set current year in footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // Initialize galaxy
            initGalaxy();
            
            // Load data
            loadData();
            
            // Setup sections
            setupSections();
            
            // Setup event listeners
            setupEventListeners();
            
            // Load state from localStorage
            state.loadFromLocalStorage();
            
            // Announce page load for screen readers
            setTimeout(() => {
                const announcement = document.createElement('div');
                announcement.setAttribute('role', 'status');
                announcement.setAttribute('aria-live', 'polite');
                announcement.className = 'sr-only';
                announcement.textContent = 'CATalyst learning platform loaded successfully';
                document.body.appendChild(announcement);
                setTimeout(() => announcement.remove(), 1000);
            }, 500);
        });

        function loadData() {
            // Load flashcards
            flashcardManager.init(allFlashcards);
            
            // Load quiz questions
            quizManager.init(quizQuestions);
            
            // Update counts
            document.getElementById('topics-count').textContent = '14';
            document.getElementById('flashcards-count').textContent = allFlashcards.length;
            document.getElementById('quiz-count').textContent = quizQuestions.length;
            document.getElementById('mindmaps-count').textContent = Object.keys(mindMaps).length;
            
            // Render topics
            renderTopics();
        }

        function renderTopics() {
            const container = document.querySelector('[aria-label="Course topics"]');
            if (!container) return;
            
            container.innerHTML = TOPIC_NAMES.map((name, index) => `
                <div class="card p-5 cursor-pointer hover:scale-[1.02] transition-transform"
                     onclick="setTopic(${index + 1})"
                     onkeydown="if(event.key === 'Enter') setTopic(${index + 1})"
                     tabindex="0"
                     role="button"
                     aria-label="Start learning ${name}">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 rounded-lg bg-gradient-to-br from-blue-900/30 to-purple-900/30 flex items-center justify-center mr-3"
                             aria-hidden="true">
                            <i class="fas fa-${getTopicIcon(index + 1)} text-blue-400 text-lg"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-white">${index + 1}. ${name}</h3>
                            <p class="text-sm text-gray-400">${getTopicDescription(index + 1)}</p>
                        </div>
                    </div>
                    <div class="progress-container mb-2">
                        <div class="progress-bar" style="width: ${Math.random() * 40 + 20}%"></div>
                    </div>
                    <p class="text-xs text-gray-400">
                        ${Math.floor(Math.random() * 15 + 5)} flashcards • ${Math.floor(Math.random() * 5 + 2)} quizzes
                    </p>
                </div>
            `).join('');
        }

        function getTopicIcon(topicId) {
            const icons = [
                'play', 'desktop', 'database', 'book', 'question-circle',
                'robot', 'edit', 'globe', 'book-open', 'star',
                'language', 'filter', 'users', 'chalkboard-teacher'
            ];
            return icons[topicId - 1] || 'book';
        }

        function getTopicDescription(topicId) {
            const descriptions = [
                'Basics and history', 'Tools and setup', 'TM systems and uses', 'For translators',
                'Challenges in MT', 'Google, DeepL, SYSTRAN', 'Editing MT output', 'Adapting products',
                'Text collections', 'Methods and metrics', 'Structural analysis', 'Restricted domains',
                'Language preservation', 'Teaching applications'
            ];
            return descriptions[topicId - 1] || 'Key concepts and applications';
        }

        function setupSections() {
            const sections = ['dashboard', 'flashcards', 'quiz', 'mindmaps', 'progress'];
            sections.forEach(id => {
                const element = document.getElementById(`${id}-section`);
                if (element) {
                    sectionManager.register(id, element, () => {
                        if (id === 'flashcards') {
                            flashcardManager.renderCurrentCard();
                            flashcardManager.renderList();
                        } else if (id === 'quiz') {
                            quizManager.renderQuestion();
                        }
                    });
                }
            });
        }

        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('[data-section]').forEach(btn => {
                btn.addEventListener('click', () => {
                    sectionManager.show(btn.dataset.section);
                });
            });
            
            // Mobile menu
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', () => {
                    const isExpanded = mobileMenuBtn.getAttribute('aria-expanded') === 'true';
                    mobileMenuBtn.setAttribute('aria-expanded', !isExpanded);
                    mobileMenu.classList.toggle('hidden');
                });
            }
            
            // Flashcard flip
            const flashcard = document.getElementById('flashcard');
            if (flashcard) {
                flashcard.addEventListener('click', () => {
                    flashcard.classList.toggle('flipped');
                });
            }
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                // Escape closes mobile menu
                if (e.key === 'Escape' && !mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                    mobileMenuBtn.setAttribute('aria-expanded', 'false');
                    mobileMenuBtn.focus();
                }
                
                // Left/right arrow for flashcards
                if (sectionManager.currentSection === 'flashcards') {
                    if (e.key === 'ArrowRight') flashcardManager.next();
                    if (e.key === 'ArrowLeft') flashcardManager.prev();
                }
            });
        }

        // Global functions
        function setTopic(topicId) {
            state.currentTopic = topicId;
            document.getElementById('topic-select').value = topicId;
            flashcardManager.filterByTopic(topicId);
            sectionManager.show('flashcards');
        }

        // Export functions to window
        window.sectionManager = sectionManager;
        window.flashcardManager = flashcardManager;
        window.quizManager = quizManager;
        window.setTopic = setTopic;

        // Original data arrays (keep your existing data here)
        const allFlashcards = [...]; // Your original flashcard data
        const quizQuestions = [...]; // Your original quiz data
        const mindMaps = {...}; // Your original mind map data
    </script>
</body>
</html>
